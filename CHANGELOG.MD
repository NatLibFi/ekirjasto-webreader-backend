# Changelog

All notable changes to this project will be documented in this file.

**Warning:** Features marked as *alpha* may change or be removed in a future release without notice. Use with caution.

## [0.6.0] - 2025-11-03

### Added

- When using the serve command, a new `-m` flag allows for authenticated access to publications using a JWT in the route to the publication instead of the encoded path. The subject (`sub`) of the JWT will instead be used as the path to the publication. The first new mode is `jwt` mode, which uses the HS256 method of authentication and a shared secret that is either provided using `--jwt-shared-secret` or autogenerated at startup. The second mode, `jwks`, is combined with the `--jwks-url` flag that points to JWKS file, which can contain multiple keys used to validate the JWT, allowing for key rotation and other algorithms using public/private keypairs
- The path of a publication with no resource specified now redirects to the manifest file

### Changed

- The GOAMD64 value for release builds has been changed from `v3` to `v2`. The discussion regarding this is [here](https://github.com/readium/cli/issues/78). This allows execution of the built binaries on older x64 CPUs
- The HTTP client configuration used for streaming of remote publications has been changed to require, at minimum, TLSv1.2 for HTTPS connections
- The serve command's routes are now prefixed with `/webpub`. So `<domain>/<path>/manifest.json` is now `<domain>/webpub/<path>/manifest.json`
- Go and third-party dependencies updated

### Removed

- The `/list.json` route in the serve command's webserver has been removed. It is not compatible with the new authenticated access schemes, and was only intended to be temporary. It may be replaced in the future by an OPDS2 feed

## [0.5.1] - 2025-10-14

### Fixed

- When a manifest has no links (such as when using the `manifest` command), the `links` property is now omitted instead of set to `null` in the JSON output
- The `--infer-page-count` works again, and general issues with services in the `manifest` command have been fixed due to a revamp in how they work in the toolkit

### Changed

- Go and third-party dependencies updated

## [0.5.0] - 2025-09-19

### Added

- The `--http-host-whitelist` flag has been added to the serve command, to which a list of hosts can be passed. If at least one host is passed, access to streamed HTTP/HTTPS publications will be restricted to the provided hosts. A host like example.com can be further restricted to a "folder", such as example.com/the/path/
- The `--http-unsafe-requests` flag has been added. It disabled restrictions that are enabled by default to prevent access to private IP addresses (such as internal infrastructure or localhost), and should be used with caution

### Fixed

- The software version displayed when using the `--version` command was incorrect due to a bug. Thanks @tefkah for the fix

### Changed

- Dependencies were updated

## [0.4.0] - 2025-07-30

### Changed

The WebPub data the go-toolkit parses and provides has been updated to more closely match the latest WebPub spec. Pay close attention to these changes if you depend on the WebPub output in reading systems/libraries that use an older version of the spec!

## [0.3.0] - 2025-07-12

### Changed

- Major changes to `readium serve` [command syntax](https://github.com/readium/cli/blob/develop/docs/serve.md), to improve ease of use
- Docker container no longer includes any test publications, an only enables http/https publication serving by default
- Improvements to documentation
- Updates to dependencies

### Fixed

- Links to services (positions list etc.) are removed from the manifest when running `readium manifest`

## [0.2.1] - 2025-06-08

### Added

- Add `--s3-use-path-style` flag to enable broader support for S3-like services that use the deprecated path-style bucket access (especially useful in docker environments)

### Fixed

- The version output from the CLI was incorrect, consisting of the go-toolkit version. [It is now](https://github.com/readium/cli/pull/32) a combination of the CLI and go-toolkit version

## [0.2.0] - 2025-05-21

### Added

- Add `--infer-a11y-ignore-image-hashes` and `--infer-a11y-ignore-image-dir` flags to `manifest` command to ignore certain images when inferring a publication's a11y access mode

### Changed

- Upgraded go-toolkit from v0.9.0 to v0.10.1
- Default hashing algorithms for inspected images changed from SHA-256 + MD5 to just SHA-256

## [0.1.0] - 2025-04-30

### Added

- Created this project based on the command-line utilities from the [https://github.com/readium/go-toolkit](Go Toolkit)